{"version":3,"sources":["../../src/utils/runAdbReverse.ts"],"names":["runAdbReverse","runtime","port","androidHome","process","env","ANDROID_HOME","adb","command","Promise","resolve","error","message","split","logger","warn","trim","done"],"mappings":";;;;;;;AAAA;;AAGe,SAASA,aAAT,CACbC,OADa,EAEbC,IAFa,EAGgB;AAC7B,QAAMC,WAAW,GAAGC,OAAO,CAACC,GAAR,CAAYC,YAAhC;AACA,QAAMC,GAAG,GAAGJ,WAAW,GAAI,GAAEA,WAAY,qBAAlB,GAAyC,KAAhE;AACA,QAAMK,OAAO,GAAI,GAAED,GAAI,gBAAeL,IAAK,QAAOA,IAAK,EAAvD;AAEA,SAAO,IAAIO,OAAJ,CAAYC,OAAO,IAAI;AAC5B,6BAAKF,OAAL,EAAcG,KAAK,IAAI;AACrB,UAAIA,KAAJ,EAAW;AACT;AACA,cAAMC,OAAO,GAAGD,KAAK,CAACC,OAAN,CAAcC,KAAd,CAAoB,QAApB,EAA8B,CAA9B,KAAoCF,KAAK,CAACC,OAA1D;AACAX,QAAAA,OAAO,CAACa,MAAR,CAAeC,IAAf,CAAqB,kBAAiBP,OAAQ,MAAKI,OAAO,CAACI,IAAR,EAAe,EAAlE;AACAN,QAAAA,OAAO;AACP;AACD;;AACDT,MAAAA,OAAO,CAACa,MAAR,CAAeG,IAAf,CAAqB,qBAAoBT,OAAQ,EAAjD;AACAE,MAAAA,OAAO;AACR,KAVD;AAWD,GAZM,CAAP;AAaD","sourcesContent":["import { exec } from 'child_process';\nimport Runtime from '../runtime/Runtime';\n\nexport default function runAdbReverse(\n  runtime: Runtime,\n  port: number\n): Promise<string | undefined> {\n  const androidHome = process.env.ANDROID_HOME;\n  const adb = androidHome ? `${androidHome}/platform-tools/adb` : 'adb';\n  const command = `${adb} reverse tcp:${port} tcp:${port}`;\n\n  return new Promise(resolve => {\n    exec(command, error => {\n      if (error) {\n        // Get just the error message\n        const message = error.message.split('error:')[1] || error.message;\n        runtime.logger.warn(`Failed to run: ${command} - ${message.trim()}`);\n        resolve();\n        return;\n      }\n      runtime.logger.done(`Successfully run: ${command}`);\n      resolve();\n    });\n  });\n}\n"],"file":"runAdbReverse.js"}