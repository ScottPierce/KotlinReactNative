{"version":3,"sources":["../../../src/preset/utils/applySingleBundleTweaks.ts"],"names":["applySingleBundleTweaks","env","templatesConfig","bundleConfig","webpackConfig","bundleOutput","output","filename","path","isAbsolute","relative","join","root","bundleTarget","platform","bundleName","name","type","dll","app","mode","dev"],"mappings":";;;;;;;AAAA;;AAOA;;;;AAEe,SAASA,uBAAT,CACbC,GADa,EAEbC,eAFa,EAGbC,YAHa,EAIbC,aAJa,EAKb;AACA,MAAIH,GAAG,CAACI,YAAR,EAAsB;AACpBD,IAAAA,aAAa,CAACE,MAAd,CAAsBC,QAAtB,GAAiCC,cAAKC,UAAL,CAAgBR,GAAG,CAACI,YAApB,IAC7BG,cAAKE,QAAL,CAAcN,aAAa,CAACE,MAAd,CAAsBE,IAApC,EAA2CP,GAAG,CAACI,YAA/C,CAD6B,GAE7BG,cAAKE,QAAL,CACEN,aAAa,CAACE,MAAd,CAAsBE,IADxB,EAEEA,cAAKG,IAAL,CAAUR,YAAY,CAACS,IAAvB,EAA6BX,GAAG,CAACI,YAAjC,CAFF,CAFJ;AAMD,GAPD,MAOO;AACLD,IAAAA,aAAa,CAACE,MAAd,CAAsBC,QAAtB,GAAiC,8BAC/BL,eAAe,CAACK,QAAhB,CACEN,GAAG,CAACY,YAAJ,KAAqB,QAArB,GAAgC,YAAhC,GAA+CV,YAAY,CAACW,QAD9D,CAD+B,EAI/B;AACEC,MAAAA,UAAU,EAAEZ,YAAY,CAACa,IAD3B;AAEEF,MAAAA,QAAQ,EAAEX,YAAY,CAACW,QAFzB;AAGEG,MAAAA,IAAI,EAAEd,YAAY,CAACe,GAAb,GAAmB,KAAnB,GAA2Bf,YAAY,CAACgB,GAAb,GAAmB,KAAnB,GAA2B,SAH9D;AAIEC,MAAAA,IAAI,EAAEjB,YAAY,CAACkB,GAAb,GAAmB,KAAnB,GAA2B;AAJnC,KAJ+B,CAAjC;AAWD;AACF","sourcesContent":["import path from 'path';\nimport webpack from 'webpack';\nimport {\n  EnvOptions,\n  NormalizedBundleConfig,\n  NormalizedTemplatesConfig,\n} from '../../config/types';\nimport compileTemplate from './compileTemplate';\n\nexport default function applySingleBundleTweaks(\n  env: EnvOptions,\n  templatesConfig: NormalizedTemplatesConfig,\n  bundleConfig: NormalizedBundleConfig,\n  webpackConfig: webpack.Configuration\n) {\n  if (env.bundleOutput) {\n    webpackConfig.output!.filename = path.isAbsolute(env.bundleOutput)\n      ? path.relative(webpackConfig.output!.path!, env.bundleOutput)\n      : path.relative(\n          webpackConfig.output!.path!,\n          path.join(bundleConfig.root, env.bundleOutput)\n        );\n  } else {\n    webpackConfig.output!.filename = compileTemplate(\n      templatesConfig.filename[\n        env.bundleTarget === 'server' ? '__server__' : bundleConfig.platform\n      ],\n      {\n        bundleName: bundleConfig.name,\n        platform: bundleConfig.platform,\n        type: bundleConfig.dll ? 'dll' : bundleConfig.app ? 'app' : 'default',\n        mode: bundleConfig.dev ? 'dev' : 'prod',\n      }\n    );\n  }\n}\n"],"file":"applySingleBundleTweaks.js"}